{"remainingRequest":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\src\\components\\manager\\Approval.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\src\\components\\manager\\Approval.vue","mtime":1633571312661},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630488426001},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":1630488426857},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630488426001},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1630488426239}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCByZXNwRmlsdGVyIGZyb20gIkAvY29tcG9uZW50cy91dGlscy9yZXNwRmlsdGVyIjsKaW1wb3J0IGdldExvY2FsVGltZSBmcm9tICJAL2NvbXBvbmVudHMvdXRpbHMvZ2V0TG9jYWxUaW1lIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiQXBwcm92YWwiLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBxdWVyeUluZm86IHsKICAgICAgICBxdWVyeTogIiIsCiAgICAgICAgcGFnZU51bTogMCwKICAgICAgICBwYWdlU2l6ZTogMiwKICAgICAgfSwKICAgICAgbGlzdDogewogICAgICAgIHF1ZXN0aW9uTGlzdDogW10sCiAgICAgIH0sCiAgICAgIGZvcm06ewogICAgICAgIHF1ZXN0aW9uU2hvd25Gb3JtOnt9LAogICAgICB9LAogICAgICB2aXNpYmlsaXR5OnsKICAgICAgICBxdWVzdGlvbkRpYWxvZ1Zpc2liaWxpdHk6IGZhbHNlLAogICAgICB9CiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuaW5pdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgaW5pdCgpIHsKICAgICAgbGV0IHsgZGF0YTogcmVzcCB9ID0gYXdhaXQgdGhpcy4kaHR0cC5wb3N0KAogICAgICAgICIvbWFuYWdlcl9nZXRfcXVlc3Rpb25fdW5yZXNvbHZlZF9pbmZvIiwKICAgICAgICB0aGlzLnF1ZXJ5SW5mbwogICAgICApOwogICAgICBpZiAoIXJlc3BGaWx0ZXIocmVzcCkpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3AubXNnKTsKICAgICAgICB0aGlzLmxvZ291dCgpOwogICAgICB9CiAgICAgIHRoaXMubGlzdC5xdWVzdGlvbkxpc3QgPSByZXNwLmRhdGE7CiAgICB9LAogICAgYWJicihzdHJpbmcsbGVuKXsKICAgICAgaWYoc3RyaW5nLmxlbmd0aDw9MipsZW4pIHJldHVybiBzdHJpbmcrbGVuOwogICAgICByZXR1cm4gc3RyaW5nID0gc3RyaW5nLnN1YnN0cigwLGxlbisyKSsiLi4uIitzdHJpbmcuc3Vic3RyKC0obGVuLTMpLGxlbi0zKQogICAgfSwKICAgIGdldENhdGVnb3J5KGVudW1DYXRlZ29yeSl7CiAgICAgIHN3aXRjaCAoZW51bUNhdGVnb3J5KXsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICByZXR1cm4gIueMq+WSquS/oeaBr+abtOatoyI7CiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIHJldHVybiAi5YW25LuWIjsKICAgICAgfQp9LAogICAgbG9jYWxUaW1lOiBmdW5jdGlvbiAobnMpewogICAgICByZXR1cm4gZ2V0TG9jYWxUaW1lKG5zKTsKICAgIH0sCiAgICBhc3luYyBzaG93RWRpdERpYWxvZyhpbmZvKXsKICAgICAgbGV0IHsgZGF0YTogcmVzcCB9ID1hd2FpdCB0aGlzLiRodHRwLnBvc3QoIi9tYW5hZ2VyX3NldF9xdWVzdGlvbl9zZWVuIixpbmZvLnF1ZXN0aW9uSWQpOwogICAgICBpZiAoIXJlc3BGaWx0ZXIocmVzcCkpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3AubXNnKTsKICAgICAgICB0aGlzLmxvZ291dCgpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLnZpc2liaWxpdHkucXVlc3Rpb25EaWFsb2dWaXNpYmlsaXR5ID0gdHJ1ZTsKICAgICAgdGhpcy5mb3JtLnF1ZXN0aW9uU2hvd25Gb3JtID0gaW5mbzsKICAgIH0sCiAgICBhc3luYyBzb2x2ZWQoKXsKICAgICAgbGV0IHsgZGF0YTogcmVzcCB9ID1hd2FpdCB0aGlzLiRodHRwLnBvc3QoIi9tYW5hZ2VyX3NldF9xdWVzdGlvbl9yZXNvbHZlZCIsdGhpcy5mb3JtLnF1ZXN0aW9uU2hvd25Gb3JtLnF1ZXN0aW9uSWQpCiAgICAgIGlmICghcmVzcEZpbHRlcihyZXNwKSkgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcC5tc2cpOwogICAgICAgIHRoaXMubG9nb3V0KCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5aSE55CG5oiQ5YqfIik7CiAgICAgIHRoaXMudmlzaWJpbGl0eS5xdWVzdGlvbkRpYWxvZ1Zpc2liaWxpdHkgPSBmYWxzZTsKICAgICAgdGhpcy5pbml0KCk7CiAgICB9CiAgfSwKfTsK"},{"version":3,"sources":["Approval.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Approval.vue","sourceRoot":"src/components/manager","sourcesContent":["<template>\n  <div>\n    <!--  面包屑导航区-->\n    <el-breadcrumb separator=\"/\">\n      <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\n      <el-breadcrumb-item>管理员菜单</el-breadcrumb-item>\n      <el-breadcrumb-item>审批</el-breadcrumb-item>\n    </el-breadcrumb>\n    <el-card>\n      <el-table :data=\"list.questionList\" stripe style=\"width: 100%\">\n        <el-table-column  label=\"ID\"><template #default=\"scope\">{{abbr(scope.row.questionId,4)}}</template></el-table-column>\n        <el-table-column  label=\"问题描述\"><template #default=\"scope\">{{abbr(scope.row.questionDescription,5)}}</template></el-table-column>\n        <el-table-column  label=\"问题类型\"><template #default=\"scope\">{{getCategory(scope.row.questionCategory)}}</template></el-table-column>\n        <el-table-column  label=\"提出时间\"><template #default=\"scope\">{{localTime(scope.row.startTime)}}</template></el-table-column>\n        <el-table-column  label=\"查看问题\"><template #default=\"scope\"><el-button type=\"primary\" icon=\"el-icon-view\" @click=\"showEditDialog(scope.row)\"></el-button></template></el-table-column>\n      </el-table>\n    </el-card>\n\n    <el-dialog title=\"信息查看\" :visible.sync=\"visibility.questionDialogVisibility\" width=\"70%\">\n      <el-descriptions class=\"margin-top\" title=\"带边框列表\" :column=\"1\"  border>\n        <template slot=\"extra\">\n          <el-button type=\"success\" size=\"small\" @click=\"solved\"><i class=\"el-icon-check\"></i> 已解决</el-button>\n        </template>\n        <el-descriptions-item>\n          <template slot=\"label\">\n            <i class=\"el-icon-paperclip\"></i>\n            问题ID\n          </template>\n          {{form.questionShownForm.questionId}}\n        </el-descriptions-item>\n        <el-descriptions-item>\n          <template slot=\"label\">\n            <i class=\"el-icon-paperclip\"></i>\n            问题分类\n          </template>\n          {{getCategory(form.questionShownForm.questionCategory)}}\n        </el-descriptions-item>\n        <el-descriptions-item>\n          <template slot=\"label\">\n            <i class=\"el-icon-watch\"></i>\n            提交时间\n          </template>\n          {{localTime(form.questionShownForm.startTime)}}\n        </el-descriptions-item>\n        <el-descriptions-item>\n          <template slot=\"label\">\n            <i class=\"el-icon-question\"></i>\n            问题描述\n          </template>\n          {{form.questionShownForm.questionDescription}}\n        </el-descriptions-item>\n        <el-descriptions-item>\n          <template slot=\"label\">\n            <i class=\"el-icon-info\"></i>\n            问题备注\n          </template>\n          {{form.questionShownForm.questionDescription}}\n        </el-descriptions-item>\n      </el-descriptions>\n\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport respFilter from \"@/components/utils/respFilter\";\nimport getLocalTime from \"@/components/utils/getLocalTime\";\n\nexport default {\n  name: \"Approval\",\n  data() {\n    return {\n      queryInfo: {\n        query: \"\",\n        pageNum: 0,\n        pageSize: 2,\n      },\n      list: {\n        questionList: [],\n      },\n      form:{\n        questionShownForm:{},\n      },\n      visibility:{\n        questionDialogVisibility: false,\n      }\n    };\n  },\n  created() {\n    this.init();\n  },\n  methods: {\n    async init() {\n      let { data: resp } = await this.$http.post(\n        \"/manager_get_question_unresolved_info\",\n        this.queryInfo\n      );\n      if (!respFilter(resp)) {\n        this.$message.error(resp.msg);\n        this.logout();\n      }\n      this.list.questionList = resp.data;\n    },\n    abbr(string,len){\n      if(string.length<=2*len) return string+len;\n      return string = string.substr(0,len+2)+\"...\"+string.substr(-(len-3),len-3)\n    },\n    getCategory(enumCategory){\n      switch (enumCategory){\n        case 1:\n          return \"猫咪信息更正\";\n        default:\n          return \"其他\";\n      }\n},\n    localTime: function (ns){\n      return getLocalTime(ns);\n    },\n    async showEditDialog(info){\n      let { data: resp } =await this.$http.post(\"/manager_set_question_seen\",info.questionId);\n      if (!respFilter(resp)) {\n        this.$message.error(resp.msg);\n        this.logout();\n        return;\n      }\n      this.visibility.questionDialogVisibility = true;\n      this.form.questionShownForm = info;\n    },\n    async solved(){\n      let { data: resp } =await this.$http.post(\"/manager_set_question_resolved\",this.form.questionShownForm.questionId)\n      if (!respFilter(resp)) {\n        this.$message.error(resp.msg);\n        this.logout();\n        return;\n      }\n      this.$message.success(\"处理成功\");\n      this.visibility.questionDialogVisibility = false;\n      this.init();\n    }\n  },\n};\n</script>\n\n<style scoped></style>\n"]}]}