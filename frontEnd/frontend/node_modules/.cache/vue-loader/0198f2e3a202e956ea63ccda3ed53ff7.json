{"remainingRequest":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\src\\components\\normalUser\\RecordAppearance.vue?vue&type=style&index=0&id=464893f2&scoped=true&lang=css&","dependencies":[{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\src\\components\\normalUser\\RecordAppearance.vue","mtime":1633173573153},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\css-loader\\dist\\cjs.js","mtime":1630488425476},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1630488427380},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\postcss-loader\\src\\index.js","mtime":1630488425847},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630488426001},{"path":"C:\\DATA\\projects\\数据库实习\\frontEnd\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":1630488426239}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5tYXJnaW5Ub3AgewogIG1hcmdpbi10b3A6IDV2aCAhaW1wb3J0YW50Owp9Ci5hdm9pZC1zaGFrZS1tYXgtd2lkdGggewogIHdpZHRoOiA5OSU7Cn0K"},{"version":3,"sources":["RecordAppearance.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqIA;AACA;AACA;AACA;AACA;AACA","file":"RecordAppearance.vue","sourceRoot":"src/components/normalUser","sourcesContent":["<script src=\"../utils/auth.js\"></script>\n<template>\n  <div>\n    <div>\n      <!--  面包屑导航区-->\n      <el-breadcrumb separator=\"/\">\n        <el-breadcrumb-item :to=\"{ path: '/home' }\">首页</el-breadcrumb-item>\n        <el-breadcrumb-item>普通用户</el-breadcrumb-item>\n        <el-breadcrumb-item>记录猫猫出现</el-breadcrumb-item>\n      </el-breadcrumb>\n    </div>\n\n    <el-card>\n      <el-row type=\"flex\" justify=\"space-between\" class=\"marginTop\">\n        <el-col :span=\"6\"></el-col>\n        <el-col :span=\"6\">\n          <el-select\n            v-model=\"selectedCatId\"\n            filterable\n            placeholder=\"请选择\"\n            @change=\"selectedCatOnchange\"\n          >\n            <el-option\n              v-for=\"cat in catInfoList\"\n              :key=\"cat.value\"\n              :label=\"cat.catName\"\n              :value=\"cat.catId\"\n            >\n            </el-option>\n          </el-select>\n        </el-col>\n        <el-col :span=\"6\"></el-col>\n      </el-row>\n      <el-row type=\"flex\" justify=\"space-between\" class=\"marginTop\">\n        <el-col :span=\"6\"></el-col>\n        <el-col :span=\"6\">\n          <img\n            v-if=\"selectedCat\"\n            :src=\"selectedCat.imgurl\"\n            alt=\"暂无图片\"\n            class=\"avoid-shake-max-width\"\n          />\n          <h1 v-else>选择猫猫以进一步操作</h1>\n        </el-col>\n        <el-col :span=\"6\"></el-col>\n      </el-row>\n      <el-row v-if=\"selectedCat\" type=\"flex\" justify=\"space-between\" class=\"marginTop\">\n        <el-col :span=\"6\"\n          >上次记录出现时间: {{ getLocalTime() }}</el-col\n        >\n        <el-col :span=\"6\"\n        >\n\n            点击上传这次的发现 :\n          <el-button v-if=\"uploadActive\" type=\"primary\" icon=\"el-icon-top\" circle @click=\"uploadFind\"></el-button>\n          <el-button v-else type=\"success\" icon=\"el-icon-check\" circle disabled></el-button>\n\n        </el-col\n        >\n        <el-col :span=\"6\"></el-col>\n      </el-row>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport respFilter from \"@/components/utils/respFilter\";\nimport config from \"@/config\";\nimport localTime from \"@/components/utils/getLocalTime\";\n\nexport default {\n  name: \"RecordAppearance\",\n  data() {\n    return {\n      catInfoList: [],\n      selectedCatId: undefined,\n      selectedCat: undefined,\n      uploadActive:true,\n    };\n  },\n  created() {\n    this.init();\n  },\n  methods: {\n    async init() {\n      let { data: resp } = await this.$http.post(\"get_cat_appearance_list\");\n      if (!respFilter(resp)) {\n        this.$message.error(resp.msg);\n        this.logout();\n      }\n      this.catInfoList = resp.data;\n    },\n    selectedCatOnchange() {\n      this.uploadActive=true;\n      let ret = null;\n      if (this.selectedCatId) {\n        this.catInfoList.forEach((item) => {\n          if (item.catId == this.selectedCatId) {\n            let url =\n              `${config.Http.baseUrl}` + \"image?imgId=\" + `${item.catPhotoId}`;\n            ret = { imgurl: url, lastFoundTime: item.lastFindTime };\n            this.selectedCat = ret;\n            return;\n          }\n        });\n        this.selectedCat = ret;\n        return;\n      }\n    },\n    getLocalTime(){\n      return localTime(this.selectedCat.lastFoundTime)\n    },\n    async uploadFind(){\n      this.uploadActive=false;\n      const { data: resp } = await this.$http.post(\"/find_cat\",this.selectedCatId);\n      console.log(resp);\n      if (!respFilter(resp)) {\n        this.$message.error(resp.msg);\n        this.logout();\n        return;\n      }\n      this.$message.success(\"登记成功\");\n      await this.init();\n      this.selectedCatOnchange();\n      this.uploadActive=false;\n      this.$forceUpdate();\n      console.log(this);\n    }\n  },\n};\n</script>\n\n<style scoped>\n.marginTop {\n  margin-top: 5vh !important;\n}\n.avoid-shake-max-width {\n  width: 99%;\n}\n</style>\n"]}]}